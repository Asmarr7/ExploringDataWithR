---
output:
  html_document: default
---
Red Wine Quality by Asma Alreshoud
========================================================


```{r echo=FALSE, message=FALSE, warning=FALSE, packages}
# Load all of the packages that you end up using in your analysis in this code
# chunk.

# Notice that the parameter "echo" was set to FALSE for this code chunk. This
# prevents the code from displaying in the knitted HTML output. You should set
# echo=FALSE for all code chunks in your file, unless it makes sense for your
# report to show the code that generated a particular plot.

# The other parameters for "message" and "warning" should also be set to FALSE
# for other code chunks once you have verified that each plot comes out as you
# want it to. This will clean up the flow of your report.

library(ggplot2)
library(knitr)
library(dplyr)
```

```{r echo=FALSE, Load_the_Data}
## Saving data
df <- read.csv("wineQualityReds.csv")
#View(df)

```


# Univariate Plots Section 

First let's explore the data: 
```{r echo=FALSE, Univariate_Plots}
dim(df)
```

```{r echo=FALSE, Univariate_Plots1}
str(df)
```

```{r echo=FALSE, Univariate_Plots2}
names(df)
```

```{r echo=FALSE, Univariate_Plots3}
summary(df)
```

The data set contains 13 variable.
```{r echo=FALSE, Univariate_Plots4}
p <- ggplot(data=df, aes(x=df$fixed.acidity))
p + geom_histogram()  
```


The fixed acidity follows mostly a normal distribution, there is some outliers at 15 and 16. 


```{r echo=FALSE, Univariate_Plots5}
p <- ggplot(data=df, aes(x=df$volatile.acidity))
p + geom_histogram() 
```


The volatile acidity also follow a normal distrribution, there is some outliers at 1.5.


```{r echo=FALSE, Univariate_Plots6}
p <- ggplot(data=df, aes(x=df$citric.acid))
p + geom_histogram() 
```
```{r echo=FALSE, Univariate_Plots7}
p <- ggplot(data=df, aes(x=df$pH))
p + geom_density(fill="darkgrey")
```


Clearly even the pH follow a normal distribution since the density of data is in the middle (3.3), and another observation from the dataset is that red wine pH doesn't exceed 4, meaning that it's acidy.


```{r echo=FALSE, Univariate_Plots8}
ggplot(df, aes(x = df$quality)) + geom_bar()
```


We see that most wine quality is of 5 and 6.


```{r echo=FALSE, Univariate_Plots9}
ggplot(df, aes(x = df$alcohol)) + geom_histogram()
```
```{r echo=FALSE, Univariate_Plots10}
ggplot(df, aes(x = df$free.sulfur.dioxide)) + geom_histogram()
```

```{r echo=FALSE, Univariate_Plots11}
ggplot(df, aes(x = df$total.sulfur.dioxide)) + geom_histogram()
```


total sulfur dioxide has some very far outliers, that may effect its mean


```{r echo=FALSE, Univariate_Plots12}
summary(df$total.sulfur.dioxide)
```

# Univariate Analysis

### What is the structure of your dataset?
There are 1599 red wine data in the dataset and there charractarrictics (fixed and volatile acidity, citrirc acid, residual sugar, chlorides, free and total sulfur dioxode, density, pH, sulphates and alchohol), X is its autogenerated unique identifier and quality is used to measure the quality of a red wine  0 (very bad) and 10 (very excellent).

Other observations:
- The median red wine fixed acidity is 7.9.
- The median red wine volatile acidity is 0.52.
- The median red wine citrric acid is 0.26.
- Most red wine has a pH of 3.3.
- Most wine quality is 5.
- The median red wine Alchohol is 10.20
- The median red wine free sulfur doxide is 14.00
- The median red wine total sulfur doxide is 38.00 

### What is/are the main feature(s) of interest in your dataset?
The main features in the data set are Alcohol and quality. Iâ€™d like to determine which features are best for predicting the quality of red wines I suspect Alchohol consitration and some combination of the other variables can be used to build a predictive model to the quality of red wine.

### What other features in the dataset do you think will help support your \
investigation into your feature(s) of interest?
fixed and volatile acidity, citrirc acid, residual sugar, chlorides, free and total sulfur dioxode, density, pH and sulphates may effect the quality of red wine. I suspect that Alchohol and pH have probibly the most effect on quality.

### Did you create any new variables from existing variables in the dataset?
no. 

### Of the features you investigated, were there any unusual distributions? \
Did you perform any operations on the data to tidy, adjust, or change the form \
of the data? If so, why did you do this?
By the mini invistgation done above, I thin kthe data is tidy and no need to fix it.

# Bivariate Plots Section
### Now let's investgate 2 variable togather

```{r echo=FALSE, Bivariate_Plots}
cormat <- cor(df)
cormat
```
```{r echo=FALSE, Bivariate_Plots1}
library(ggcorrplot)
ggcorrplot(cormat, hc.order = TRUE, 
           type = "lower", 
           lab = TRUE, 
           lab_size = 3, 
           method="circle", 
           colors = c("tomato2", "white", "springgreen3"), 
           title="Correlogram of RRed Wines", 
           ggtheme=theme_bw)
```


From the above correlation matrix, we see that the fixed acidity correlates with density and pH(nigatively), citric acid correlates with fixed acidity, free sulfur dioxide corrrelates with total sulfur dioxide. Most importantly the quality of rred wine mostly correlates with Alchohol. 

The coefficients heatmap helps with deciding which variables to investgate.

Fisrt, let's see the effect of (fixed acidity) on (density):

```{r echo=FALSE, Bivariate_Plots2}
p <- ggplot(df, aes(df$fixed.acidity, df$density))
p + geom_bin2d()
```

As shown above there is a positive correlation between them, meaning that the higher fixed acidity the higher the density gets. From the counts we also see that red wines with fixed acidity of between 7 and 8 are most likely to have density of between 0.995 to 0.9975 (approximately).

Now let's see the effect of (fixed acidity) on (pH):

```{r echo=FALSE, Bivariate_Plots3}
p <- ggplot(df, aes(df$fixed.acidity, df$pH))
p + geom_bin2d()
```

As shown above there is a negative correlation between them, meaning that the higher fixed acidity the lower the pH gets (which is somewhat logical since acid components have lower pH). From the counts we also see that red wines with fixed acidity of between 7 and 8 are most likely to have pH of between 3.25 to 3.45 (approximately).

Now let's investegate the realtionship between citric acid and fixed acidity:

```{r echo=FALSE, Bivariate_Plots4}
ggplot(df, aes(x=df$citric.acid, y=df$fixed.acidity)) +
    geom_point(shape=1) +    
    geom_smooth(method=lm)
```

From the graph above (I added a linear regression line, and the shadded area is a 95% confidence region), we crearly see that there is a positive correlation, meaning that incrreasing red wine's citric acid may increase it's fixed acidity (very logical).

Now let's see the effect of (free sulfur dioxide) on (total sulfur dioxide):

```{r echo=FALSE, Bivariate_Plots5}
ggplot(df, aes(x=df$free.sulfur.dioxide, y=df$total.sulfur.dioxide)) +
    geom_point(shape=1) +    
    geom_smooth(method=lm)
```

From the graph above (I added a linear regression line, and the shadded area is a 95% confidence region), we crearly see that there is a positive correlation, meaning that incrreasing red wine's free sulfur dioxide may increase it's total sulfur dioxide.

### Now for the most important factor which is the quality of a red wine, from the above analysis we see that the quality of red wine mostly correlates with Alchohol.

```{r echo=FALSE, Bivariate_Plots6}
ggplot(df, aes(x=df$quality, y=df$alcohol)) + 
  geom_bar(stat="identity", width=.5, fill="tomato3") + 
  labs( subtitle="Quality Vs Avg. Alchohol") + 
  theme(axis.text.x = element_text(angle=65, vjust=0.6))
```

The bar chart didn't give a verry strong indecation about the relationship, there is good quality wines with few Alchohol persentage and vise versa.

Let's try something clearer.

```{r echo=FALSE, Bivariate_Plots7}
ggplot(df, aes(x=df$quality, y=df$alcohol, group = 1)) + geom_bin2d()
```

High quality red wine have variant Alchohol concentration, but in general we see that higher quality wines have higher Alchohol concentrations.

```{r echo=FALSE, Bivariate_Plots8}
ggplot(df, aes(x=df$quality, y=df$alcohol, group = 1)) +     geom_point(shape=1) +    
    geom_smooth(method=lm)
```

There are some outliers clearly, but the over all trends proves that higher quality wines have higher Alchohol concentrations.

### Now let's investegate the quality of red wine and pH.

```{r echo=FALSE, Bivariate_Plots9}
ggplot(df, aes(x=df$quality, y=df$pH)) + 
  geom_bar(stat="identity", width=.5, fill="tomato3") + 
  labs( subtitle="Quality Vs Avg. pH") + 
  theme(axis.text.x = element_text(angle=65, vjust=0.6))
```

Same as the Alchohol, there is a weak indication.

```{r echo=FALSE, Bivariate_Plots10}
ggplot(df, aes(x=df$quality, y=df$pH, group = 1)) + geom_bin2d()
```

And finally,

```{r echo=FALSE, Bivariate_Plots11}
ggplot(df, aes(x=df$quality, y=df$pH, group = 1)) +     geom_point(shape=1) +    
    geom_smooth(method=lm)
```

There is a very small differrence in the pH of higher quality wines, they tend to have less pH.

# Bivariate Analysis

### Talk about some of the relationships you observed in this part of the \
investigation. How did the feature(s) of interest vary with other features in \
the dataset?
1- fixed acidity positively correlates with density, meaning that the higher fixed acidity the higher the density gets.
2- fixed acidity negatively correlates with pH, meaning that the higher fixed acidity the lower the pH gets. which is something that happens norrmally in nature.
3- citric acid positively correlates with fixed acidity, meaning that incrreasing red wine's citric acid may increase it's fixed acidity. which is something that also happens in nature.
4- free sulfur dioxide positively correlates with total sulfur dioxide, meaning that incrreasing red wine's free sulfur dioxide may increase it's total sulfur dioxide.
5- Quality positively correlates with Alchohol, meaning that higher quality wines have higher Alchohol concentrations.
6- Quality negatively correlates with pH, meaning that higher quality wines have less pH.

### Did you observe any interesting relationships between the other features \
(not the main feature(s) of interest)?
no.
### What was the strongest relationship you found?
Fixed acidity and pH

# Multivariate Plots Section

### Now let's invistegate 3 varriables together

```{r echo=FALSE, Multivariate_Plots}
ggplot(df, aes(x=df$fixed.acidity, y=df$pH, color=df$quality)) +
  geom_point() + 
  geom_jitter(aes(col=df$quality, size=df$quality)) + 
  geom_smooth(aes(col=df$quality), method="lm", se=F)

```

# Multivariate Analysis

### Talk about some of the relationships you observed in this part of the \
investigation. Were there features that strengthened each other in terms of \
looking at your feature(s) of interest?
Since there is a relationship between fixed acidity and pH and a relationship between pH and quality, I've combined both to see if there is a hidden relationship.
### Were there any interesting or surprising interactions between features?
The intresting thing is that there is no dirict indecator of good quality red wine. The quality of a rred wine is a combination of multiple things and perhabs therre is morre factors to be considered that wasn't mentioned such as the aging of wine and so on.


------

# Final Plots and Summary


### Plot One
```{r echo=FALSE, Plot_One}
p <- ggplot(data=df, aes(x=df$pH))
p + geom_density(fill="powderblue")+ labs(title="destribution of pH") + xlab('pH')
```

### Description One
This is a very simple univariant density plot, the reason that a choose this plot is that it made me relize that natural elements arre usally normally distributed, this proves this theory, since pH is a natural element not created by humans or mechines. 

### Plot Two
```{r echo=FALSE, Plot_Two}
library(ggcorrplot)
ggcorrplot(cormat, hc.order = TRUE, 
           type = "lower", 
           lab = TRUE, 
           lab_size = 3, 
           method="circle", 
           colors = c("tomato2", "white", "springgreen3"), 
           title="Correlogram of mtcars", 
           ggtheme=theme_bw)
```

### Description Two
This is a very important plot as it's the basis to start creating bivariant plots, analysing each correlation coefficient helps with knowing which factors effect which.

### Plot Three
```{r echo=FALSE, Plot_Three}
ggplot(df, aes(x=df$fixed.acidity, y=df$pH, color=df$quality)) +
  geom_point() + 
  geom_jitter(aes(col=df$quality, size=df$quality)) + 
  geom_smooth(aes(col=df$quality), method="lm", se=F) + labs(title="Fixed Acidity vs. pH vs. Quality") + xlab('Fixed Acidity') + ylab('pH')

```

### Description Three
This plot show that even though there is a rrelationship between two variable it doesn't nessesarrly have to effect other variables.
------

# Reflection
The most challenging thing about this dataset is that it contains only numric data, which is not very visible like having catacorecal data. As future work a would like to create categories to better analyse the dataset.


